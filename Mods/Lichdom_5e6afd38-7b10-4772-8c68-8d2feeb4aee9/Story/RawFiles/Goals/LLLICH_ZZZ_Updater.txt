Version 1
SubGoalCombiner SGC_AND
INITSECTION
LeaderUpdater_Register_Mod("Lichdom", "LaughingLeader", "0.9.5.3");
LeaderUpdater_Register_ActiveGoal("Lichdom", "LaughingLeader", "LLLICH_ZZZ_Updater");
LeaderUpdater_Register_Dependency("Lichdom", "LaughingLeader", "AnimationsPlus", "LaughingLeader", 1);
LeaderLib_Register_ModMenu("LaughingLeader.Lichdom", "[Lichdom] Settings", "LLLICH_SettingsMenu", "Lichdom", "LaughingLeader");
LeaderLib_PresetMenu_RegisterPreset("LLLICH_Lich", "Lich [Lichdom]", "Lichdom_IsActive");

KBSECTION
IF
GameStarted(_,_)
AND
LeaderUpdater_QRY_ModUpdateNeeded("Lichdom", "LaughingLeader", "0.9.5.3")
THEN
LeaderUpdater_Register_Mod("Lichdom", "LaughingLeader", "0.9.5.3");

/*
PROC
LeaderUpdater_ModUpdated("Lichdom", "LaughingLeader", (STRING)_OldVersion, "0.9.9.0")
AND
NOT DB_LeaderUpdater_Dependency("Lichdom", "LaughingLeader", "AnimationsPlus", "LaughingLeader", _)
THEN
LeaderUpdater_Register_Dependency("Lichdom", "LaughingLeader", "AnimationsPlus", "LaughingLeader", 1);
*/

//REGION UPDATES
PROC
LeaderUpdater_ModUpdated("Lichdom", "LaughingLeader", (STRING)_PastVersion, (STRING)_NewVersion)
AND
LeaderLib_StringExt_QRY_VersionIsLessThan(_PastVersion, 0, 9, 5, 3)
AND
DB_IsPlayer(_Lich)
AND
IsTagged(_Lich, "LLLICH_Lich", 1)
THEN
SetStoryEvent(_Lich, "LLLICH_ApplyLichPenalty");

PROC
LeaderUpdater_ModUpdated("Lichdom", "LaughingLeader", (STRING)_PastVersion, (STRING)_NewVersion)
AND
LeaderLib_StringExt_QRY_VersionIsLessThan(_PastVersion, 0, 9, 5, 0)
THEN
NOT DB_LLLICH_LichSkills("Phylactery","Target_LLLICH_DrainSoul", 0);
DB_LLLICH_LichSkills("LichForm","Target_LLLICH_DrainSoul", 0);
LLLICH_Main_InitSettings();
LLLICH_Phylactery_InitSettings();

//_Actived added to Phylactery DB
LLLICH_Main_Debug_Update_MigrateDB();

LLLICH_Phylactery_Debug_StatsReload_ReplacePhylacteries_Start();

SysClear("DB_LLLICH_LichSkills", 1);
LLLICH_Main_Internal_UpdateLichSkills();

TimerCancel("LLLICH_Timers_Debug_RunPhylacterySanityCheck");
TimerLaunch("LLLICH_Timers_Debug_RunPhylacterySanityCheck", 500);

//Permanent statuses become status influences instead
PROC
LeaderUpdater_ModUpdated("Lichdom", "LaughingLeader", (STRING)_PastVersion, (STRING)_NewVersion)
AND
LeaderLib_StringExt_QRY_VersionIsLessThan(_PastVersion, 0, 9, 1, 2)
AND
DB_IsPlayer(_Player)
AND
IsTagged(_Player, "LLLICH_Lich", 1)
THEN
LLLICH_Main_Internal_LichUpdate(_Player);
//END_REGION

EXITSECTION

ENDEXITSECTION
ParentTargetEdge "LaughingLeader_Lichdom"